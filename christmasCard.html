<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <link rel="stylesheet" href="christmas/css/card.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <title>Merry christmas ğŸ„</title>
    <meta property="og:title" content="Merry christmas ğŸ„" />
    <meta property="og:description" content="Merry christmas ğŸ„" />
    <meta
      property="og:image"
      content="https://christmascardfromjinyi.netlify.app/image.png"
    />
    <script
      src="https://code.jquery.com/jquery-3.6.3.min.js"
      integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
      crossorigin="anonymous"
    ></script>
  </head>
  <body onload="init()" onresize="init()">
    <div class="wrapper">
      <div
        id="card"
        class="card paper"
        onmousemove="handleMouseMove()"
        onmouseleave="reset()"
        ontouchend="reset()"
      >
        <div
          id="card__wrapper"
          class="card__wrapper"
          style="transform: rotateX(-10deg) rotateY(0deg)"
        >
          <div id="card__top" class="card__top">
            <img
              class="card__top__img__bg"
              src="https://files.vingle.network/processed?key=files/G0CUWIRCRG/FI1SIFOQP/backgroundimage.jpg&type=ratio&value=3:2&scale=md"
              alt="ë°°ê²½ ì´ë¯¸ì§€"
            />
          </div>
          <img
            class="card__top__img__1"
            src="https://files.vingle.network/processed?key=files/G0CUWIRCRG/FZRXYQ25R/trees-1.png&type=ratio&value=16:9&scale=md"
            alt="trees"
          />
          <img
            class="card__top__img__2"
            src="https://files.vingle.network/processed?key=files/G0CUWIRCRG/FTONWE46T/trees-2.png&type=ratio&value=16:9&scale=md"
            alt="trees2"
          />
          <img
            class="card__top__img__3"
            src="https://files.vingle.network/processed?key=files/G0CUWIRCRG/FQ8C82DEW/santa.png&type=ratio&value=16:9&scale=md"
            alt="santa"
          />
          <img
            class="card__top__img__4"
            src="https://files.vingle.network/files/G0CUWIRCRG/FIJCQ53PT/gifts.png"
            alt="gifts"
          />
          <div id="card__bottom" class="card__bottom">
            <p class="card__bottomTxt">
              <b id="message_who">Merry christmas ğŸ„</b><br />
              <span
                id="message"
                style="
                  display: inline-block;
                  font-size: 22px;
                  padding-top: 26px;
                "
              >
                Wishing you the happiest holidays <br />
                and a wonderful New Year in 2023!
              </span>
            </p>
          </div>
        </div>
      </div>
      <div class="description">ë§ˆìš°ìŠ¤ë¥¼ ë°•ìŠ¤ ì•ˆì—ì„œ ì›€ì§ì—¬ë³´ì„¸ìš”!</div>
    </div>
    <div class="mobile">ë°ìŠ¤í¬íƒ‘ìœ¼ë¡œ í™•ì¸í•´ì£¼ì„¸ìš”!</div>

    <script>
      let $cardWrapper;
      let $cardTop, $cardBottom;
      let centerY, centerX;

      function getQueryParameter(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      function updateTextContent(id, text) {
        const element = document.getElementById(id);

        if (element && text) {
          // '__br__' ë¬¸ìì—´ì„ '<br />'ë¡œ ë³€í™˜
          const updatedText = text.replace(/__br__/g, '<br />');
          element.innerHTML = updatedText; // innerHTMLì„ ì‚¬ìš©í•˜ì—¬ HTML íƒœê·¸ë¥¼ ì˜¬ë°”ë¥´ê²Œ ë Œë”ë§
        }
      }

      function init() {
        $card = document.getElementById("card");
        $cardWrapper = document.getElementById("card__wrapper");
        $cardTop = document.getElementById("card__top");
        $cardBottom = document.getElementById("card__bottom");

        // ì¤‘ì•™ ì¢Œí‘œê°’
        centerY = $cardTop.getBoundingClientRect().bottom;
        centerX =
          $cardTop.getBoundingClientRect().left +
          ($cardTop.getBoundingClientRect().right -
            $cardTop.getBoundingClientRect().left) /
            2;

        const whoText = getQueryParameter('who');
        const messageText = getQueryParameter('message');

        updateTextContent('message_who', whoText);
        updateTextContent('message', messageText);
      }

      function reset() {
        $cardWrapper.style = "transform: rotateX(-10deg) rotateY(0deg);";
      }

      function handleMouseMove(event) {
        let eventDoc, doc, body;

        event = event || window.event;

        // ë§ˆìš°ìŠ¤ ì¢Œí‘œ
        // touch event ë¶„ê¸°ì²˜ë¦¬
        let pageX = event.pageX ?? event.changedTouches[0].pageX;
        let pageY = event.pageY ?? event.changedTouches[0].pageY;

        let rotateX, rotateY;

        // rotateX
        if (pageX <= centerX) {
          // ì¤‘ì•™ ì¢Œí‘œê°’ë³´ë‹¤ ì‘ì„ ë•Œ
          rotateX = (centerX - pageX) * 0.4;
          rotateX > 80 ? (rotateX = 80) : (rotateX = rotateX);
        } else {
          // ì¤‘ì•™ ì¢Œí‘œê°’ë³´ë‹¤ í´ ë•Œ
          rotateX = (centerX - pageX) * 0.4;
          rotateX < -80 ? (rotateX = -80) : (rotateX = rotateX);
        }

        // rotateY
        if (pageY <= centerY) {
          // ì¤‘ì•™ ì¢Œí‘œê°’ë³´ë‹¤ ì‘ì„ ë•Œ
          rotateY = (centerY - pageY) * 0.3;
          rotateY > 20 ? (rotateY = 20) : (rotateY = rotateY);
        } else {
          // ì¤‘ì•™ ì¢Œí‘œê°’ë³´ë‹¤ í´ ë•Œ
          rotateY = (centerY - pageY) * 0.3;
          rotateY < -40 ? (rotateY = -40) : (rotateY = rotateY);
        }

        $cardWrapper.style =
          "transform: rotateX(" + rotateY + "deg) rotateY(" + rotateX + "deg);";
      }
    </script>
  </body>
</html>
